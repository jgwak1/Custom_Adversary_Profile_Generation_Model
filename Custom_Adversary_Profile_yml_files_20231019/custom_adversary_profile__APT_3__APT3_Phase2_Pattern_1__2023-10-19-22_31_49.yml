adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_1__2023-10-19-22_31_49
name: Custom Adversary Profile
description: [['stockpile__privilege_escalation', 'atomic__privilege_escalation'], ['stockpile__persistence', 'atomic__persistence'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- 1d3d2e634f1bc294f04ce84944b30de9 # ('1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me') ; {'description': 'Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_PowerShell"\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1136.001', 'name': 'Create Account: Local Account'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-LocalUser -Name "T1136.001_PowerShell" -ErrorAction Ignore', 'command': 'New-LocalUser -Name "T1136.001_PowerShell" -NoPassword', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me'], 'plugin': 'atomic'}
- 6b96fa3cbc72bc6771572a924a31b15d # ('6b96fa3cbc72bc6771572a924a31b15d', 'None', 'validate_me') ; {'description': 'Map Admin share utilizing PowerShell\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.002', 'name': 'Remote Services: SMB/Windows Admin Shares'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'New-PSDrive -name g -psprovider filesystem -root \\\\Target\\C$', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['6b96fa3cbc72bc6771572a924a31b15d', 'None', 'validate_me'], 'plugin': 'atomic'}
- 523898649ff03b6f6051b5f92f24e9c9 # ('523898649ff03b6f6051b5f92f24e9c9', 'None', 'validate_me') ; {'description': 'Execution of a PowerShell payload from the Windows Registry similar to that seen in fileless malware infections. Upon exection, open "C:\\Windows\\Temp" and verify that\nart-marker.txt is in the folder.\n', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.001', 'name': 'Command and Scripting Interpreter: PowerShell'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-Item -path C:\\Windows\\Temp\\art-marker.txt -Force -ErrorAction Ignore; Remove-Item HKCU:\\Software\\Classes\\AtomicRedTeam -Force -ErrorAction Ignore', 'command': 'reg.exe add "HKEY_CURRENT_USER\\Software\\Classes\\AtomicRedTeam" /v ART /t REG_SZ /d "U2V0LUNvbnRlbnQgLXBhdGggIiRlbnY6U3lzdGVtUm9vdC9UZW1wL2FydC1tYXJrZXIudHh0IiAtdmFsdWUgIkhlbGxvIGZyb20gdGhlIEF0b21pYyBSZWQgVGVhbSI="; iex ([Text.Encoding]::ASCII.GetString([Convert]::FromBase64String((gp \'HKCU:\\Software\\Classes\\AtomicRedTeam\').ART)))', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['523898649ff03b6f6051b5f92f24e9c9', 'None', 'validate_me'], 'plugin': 'atomic'}
- 4688d6eebcad6536896d298a7f22c733 # ('4688d6eebcad6536896d298a7f22c733', 'None', 'None') ; {'description': 'Change the password on the Directory Service Restore Mode (DSRM) account using ntdsutil by syncing to existing account\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1098', 'name': 'Account Manipulation'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'ntdsutil "set dsrm password" "sync from domain account %username%" "q" "q"', 'payloads': []}}}, 'id__dependence__fact': ['4688d6eebcad6536896d298a7f22c733', 'None', 'None'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []