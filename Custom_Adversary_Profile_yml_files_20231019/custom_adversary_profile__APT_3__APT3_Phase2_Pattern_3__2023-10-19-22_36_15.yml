adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_3__2023-10-19-22_36_15
name: Custom Adversary Profile
description: [['stockpile__discovery', 'atomic__discovery'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- 5542e43c5f972ee1492edab2283dd1f6 # ('5542e43c5f972ee1492edab2283dd1f6', 'None', 'validate_me') ; {'description': 'Launches the DirLister executable for a short period of time and then exits.\n\nRecently seen used by [BlackCat ransomware](https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/) to create a list of accessible directories and files.', 'tactic': 'discovery', 'technique': {'attack_id': 'T1083', 'name': 'File and Directory Discovery'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'Start-Process PathToAtomicsFolder\\T1083\\bin\\DirLister.exe; Start-Sleep -Second 4; Stop-Process -Name "DirLister"', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['5542e43c5f972ee1492edab2283dd1f6', 'None', 'validate_me'], 'plugin': 'atomic'}
- 34020258ec67d5ceaaa6ad892639e69d # ('34020258ec67d5ceaaa6ad892639e69d', 'None', 'None') ; {'description': 'Executes a command, writing the output to a local Admin Share.\nThis technique is used by post-exploitation frameworks.\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.002', 'name': 'Remote Services: SMB/Windows Admin Shares'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'cmd.exe /Q /c hostname 1> \\\\127.0.0.1\\ADMIN$\\output.txt 2>&1', 'payloads': []}}}, 'id__dependence__fact': ['34020258ec67d5ceaaa6ad892639e69d', 'None', 'None'], 'plugin': 'atomic'}
- b7d34f7b28d202f7216f3afdb889bf5d # ('b7d34f7b28d202f7216f3afdb889bf5d', 'None', 'validate_me') ; {'description': 'Executes powershell.exe with variations of the -EncodedCommand parameter with encoded arguments supplied', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.001', 'name': 'Command and Scripting Interpreter: PowerShell'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': '$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable; if (-not $RequiredModule) {Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force};  ;  Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType Hyphen -EncodedCommandParamVariation E -UseEncodedArguments -EncodedArgumentsParamVariation EncodedArguments -Execute -ErrorAction Stop', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['b7d34f7b28d202f7216f3afdb889bf5d', 'None', 'validate_me'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []