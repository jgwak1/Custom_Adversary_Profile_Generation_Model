adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_1__2023-10-19-22_32_34
name: Custom Adversary Profile
description: [['stockpile__privilege_escalation', 'atomic__privilege_escalation'], ['stockpile__persistence', 'atomic__persistence'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- 1d3d2e634f1bc294f04ce84944b30de9 # ('1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me') ; {'description': 'Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_PowerShell"\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1136.001', 'name': 'Create Account: Local Account'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-LocalUser -Name "T1136.001_PowerShell" -ErrorAction Ignore', 'command': 'New-LocalUser -Name "T1136.001_PowerShell" -NoPassword', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me'], 'plugin': 'atomic'}
- 0dceba0336f08525bbd06a05c7b4e671 # ('0dceba0336f08525bbd06a05c7b4e671', 'None', 'validate_me') ; {'description': 'Changing RDP Port to Non Standard Port via Remote Desktop Application over Powershell\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.001', 'name': 'Remote Services: Remote Desktop Protocol'}, 'platforms': {'windows': {'psh': {'cleanup': 'Set-ItemProperty -Path \'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\' -name "PortNumber" -Value 3389; Remove-NetFirewallRule -DisplayName "RDPPORTLatest-TCP-In" -ErrorAction ignore', 'command': 'Set-ItemProperty -Path \'HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\' -name "PortNumber" -Value 4489; New-NetFirewallRule -DisplayName \'RDPPORTLatest-TCP-In\' -Profile \'Public\' -Direction Inbound -Action Allow -Protocol TCP -LocalPort 4489', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['0dceba0336f08525bbd06a05c7b4e671', 'None', 'validate_me'], 'plugin': 'atomic'}
- b7d34f7b28d202f7216f3afdb889bf5d # ('b7d34f7b28d202f7216f3afdb889bf5d', 'None', 'validate_me') ; {'description': 'Executes powershell.exe with variations of the -EncodedCommand parameter with encoded arguments supplied', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.001', 'name': 'Command and Scripting Interpreter: PowerShell'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': '$RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable; if (-not $RequiredModule) {Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force};  ;  Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType Hyphen -EncodedCommandParamVariation E -UseEncodedArguments -EncodedArgumentsParamVariation EncodedArguments -Execute -ErrorAction Stop', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['b7d34f7b28d202f7216f3afdb889bf5d', 'None', 'validate_me'], 'plugin': 'atomic'}
- e6649419baf4d28d52e191caf07b5f53 # ('e6649419baf4d28d52e191caf07b5f53', 'None', 'None') ; {'description': 'Creates a new user in a command prompt. Upon execution, "The command completed successfully." will be displayed. To verify the\nnew account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_CMD"\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1136.001', 'name': 'Create Account: Local Account'}, 'platforms': {'windows': {'cmd': {'cleanup': 'net user /del "T1136.001_CMD" >nul 2>&1', 'command': 'net user /add "T1136.001_CMD" "T1136.001_CMD!"', 'payloads': []}}}, 'id__dependence__fact': ['e6649419baf4d28d52e191caf07b5f53', 'None', 'None'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []