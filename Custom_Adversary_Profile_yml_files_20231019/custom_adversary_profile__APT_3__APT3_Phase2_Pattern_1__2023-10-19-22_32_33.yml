adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_1__2023-10-19-22_32_33
name: Custom Adversary Profile
description: [['stockpile__privilege_escalation', 'atomic__privilege_escalation'], ['stockpile__persistence', 'atomic__persistence'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- 4688d6eebcad6536896d298a7f22c733 # ('4688d6eebcad6536896d298a7f22c733', 'None', 'None') ; {'description': 'Change the password on the Directory Service Restore Mode (DSRM) account using ntdsutil by syncing to existing account\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1098', 'name': 'Account Manipulation'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'ntdsutil "set dsrm password" "sync from domain account %username%" "q" "q"', 'payloads': []}}}, 'id__dependence__fact': ['4688d6eebcad6536896d298a7f22c733', 'None', 'None'], 'plugin': 'atomic'}
- 716745153b22c35bf39d177e28ce7bf6 # ('716745153b22c35bf39d177e28ce7bf6', 'None', 'None') ; {'description': 'Copies a file to a remote host and executes it using PsExec. Requires the download of PsExec from [https://docs.microsoft.com/en-us/sysinternals/downloads/psexec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec).\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.002', 'name': 'Remote Services: SMB/Windows Admin Shares'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'C:\\PSTools\\PsExec.exe \\\\localhost -accepteula -c C:\\Windows\\System32\\cmd.exe', 'payloads': []}}}, 'id__dependence__fact': ['716745153b22c35bf39d177e28ce7bf6', 'None', 'None'], 'plugin': 'atomic'}
- 91711bb1e9ad7268f211ad94afa4ccdb # ('91711bb1e9ad7268f211ad94afa4ccdb', 'None', 'validate_me') ; {'description': 'Creates and executes a simple batch script. Upon execution, CMD will briefly launch to run the batch script then close again.\n', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.003', 'name': 'Command and Scripting Interpreter: Windows Command Shell'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-Item $env:TEMP\\T1059.003_script.bat -Force -ErrorAction Ignore', 'command': 'Start-Process $env:TEMP\\T1059.003_script.bat', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['91711bb1e9ad7268f211ad94afa4ccdb', 'None', 'validate_me'], 'plugin': 'atomic'}
- 1d3d2e634f1bc294f04ce84944b30de9 # ('1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me') ; {'description': 'Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_PowerShell"\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1136.001', 'name': 'Create Account: Local Account'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-LocalUser -Name "T1136.001_PowerShell" -ErrorAction Ignore', 'command': 'New-LocalUser -Name "T1136.001_PowerShell" -NoPassword', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['1d3d2e634f1bc294f04ce84944b30de9', 'None', 'validate_me'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []