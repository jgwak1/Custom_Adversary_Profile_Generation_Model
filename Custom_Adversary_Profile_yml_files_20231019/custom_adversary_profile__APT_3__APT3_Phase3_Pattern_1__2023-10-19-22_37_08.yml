adversary_id: custom_adversary_profile__APT_3__APT3_Phase3_Pattern_1__2023-10-19-22_37_08
name: Custom Adversary Profile
description: [['stockpile__defense-evasion', 'atomic__defense-evasion'], ['stockpile__lateral-movement', 'atomic__lateral-movement'], ['stockpile__execution', 'atomic__execution']]
atomic_ordering:
- effd1be56656c570e7d336f2b3673868 # ('effd1be56656c570e7d336f2b3673868', 'None', 'validate_me') ; {'description': 'Rundll32.exe running non-dll \n', 'tactic': 'defense-evasion', 'technique': {'attack_id': 'T1218.011', 'name': 'Signed Binary Proxy Execution: Rundll32'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'rundll32.exe C:\\Users\\$env:username\\Downloads\\calc.png, StartW', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['effd1be56656c570e7d336f2b3673868', 'None', 'validate_me'], 'plugin': 'atomic'}
- 5f2a68667604f0e3f8188d2a083fbcc5 # ('5f2a68667604f0e3f8188d2a083fbcc5', 'None', 'validate_me') ; {'description': 'Attempt an RDP session via Remote Desktop Application over Powershell\n', 'tactic': 'lateral-movement', 'technique': {'attack_id': 'T1021.001', 'name': 'Remote Services: Remote Desktop Protocol'}, 'platforms': {'windows': {'psh': {'cleanup': '$p=Tasklist /svc /fi "IMAGENAME eq mstsc.exe" /fo csv | convertfrom-csv; if(-not ([string]::IsNullOrEmpty($p.PID))) { Stop-Process -Id $p.PID }', 'command': '$Server="#{logonserver}"; $User="#{username}"; $Password="#{password}"; cmdkey /generic:TERMSRV/$Server /user:$User /pass:$Password; mstsc /v:$Server; echo "RDP connection established"', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['5f2a68667604f0e3f8188d2a083fbcc5', 'None', 'validate_me'], 'plugin': 'atomic'}
- d9f569d91554884ce195f36546a475a4 # ('d9f569d91554884ce195f36546a475a4', 'None', 'None') ; {'description': 'Simulate Raspberry Robin using the "standard-in" command prompt feature cmd `/R <` to read and execute a file via cmd.exe\nSee https://redcanary.com/blog/raspberry-robin/. \n', 'tactic': 'execution', 'technique': {'attack_id': 'T1059.003', 'name': 'Command and Scripting Interpreter: Windows Command Shell'}, 'platforms': {'windows': {'cmd': {'cleanup': '', 'command': 'cmd /r cmd<07a87d_t1059.003_cmd.cmd', 'payloads': ['07a87d_t1059.003_cmd.cmd']}}}, 'id__dependence__fact': ['d9f569d91554884ce195f36546a475a4', 'None', 'None'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []